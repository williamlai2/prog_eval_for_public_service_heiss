"0","# Estimate causal effect of Catholic schools on math scores"
"0","# Treatment model"
"0","model_school_treatment <- glm(catholic ~ I(inc8^2) + (inc8*math8) + fhowfar + "
"0","                                mhowfar + fight8 + nohw8 + disrupt8 + riskdrop8,"
"0","                              data = school_data,"
"0","                              family = binomial(link = ""logit""))"
"0",""
"0","# Propensity scores and inverse probability of treatment weights (IPTW)"
"0","school_iptw <- augment(model_school_treatment, school_data, "
"0","                       type.predict = ""response"") %>%"
"0","  rename(propensity = .fitted) %>% "
"0","  mutate(iptw = (catholic / propensity) + ((1 - catholic) / (1 - propensity)))"
"0",""
"0","# Outcome model"
"0","model_school_ate <- lm(math12 ~ catholic,"
"0","                       data = school_iptw,"
"0","                       weights = iptw)"
"0",""
"0","tidy(model_school_ate, conf.int = TRUE)"
